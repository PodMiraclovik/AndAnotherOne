<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Serverless Image Processing</title>
</head>
<body>
    <h1>Serverless Image Processing</h1>
    <p>Upload an image and see how it will be processed using a serverless function on Vercel.</p>
    <form action="/api/image" method="post" enctype="multipart/form-data">
        <input type="file" name="image" accept="image/*" required>
        <input type="submit" value="Upload">
    </form>
    <div id="result"></div>
    <script>
        // Получаем элементы формы и результата
        const form = document.querySelector("form");
        const result = document.querySelector("#result");

        // Добавляем обработчик события отправки формы
        form.addEventListener("submit", async (event) => {
            // Отменяем действие по умолчанию
            event.preventDefault();

            // Создаем объект FormData с данными формы
            const formData = new FormData(form);

            // Отправляем запрос к бессерверной функции
            const response = await fetch("/api/image", {
                method: "POST",
                body: formData,
            });

            // Проверяем статус ответа
            if (response.ok) {
                // Получаем URL обработанного изображения
                const imageUrl = await response.text();

                // Создаем элемент изображения с этим URL
                const image = document.createElement("img");
                image.src = imageUrl;

                // Очищаем и добавляем элемент изображения в результат
                result.innerHTML = "";
                result.appendChild(image);
            } else {
                // Выводим сообщение об ошибке
                result.textContent = "An error occurred while processing the image.";
            }
        });
    </script>
</body>
</html>
